{"version":3,"sources":["../../src/polyfill/jsx-custom-event.ts","config.ts","pages/vue3/vue3.tsx"],"names":["React","eventLifeCycles","jsxCustomEvent","type","props","children","test","createElement","apply","newProps","Object","assign","ref","element","current","key","toString","call","data","prototype","hasOwnProperty","includes","toLowerCase","eventName","replace","removeEventListener","addEventListener","module","exports","default","config","nextjs11","nuxtjs2","react16","react17","sidebar","vite","vue2","vue3","webpack5","keys","forEach","window","location","origin","protocol","hostname","Vue3","useState","msg","microAppData","changeMicroAppData","name","url","baseroute","onCreated","console","log","onBeforemount","onMounted","setTimeout","onUnmount","onError","onDataChange","e","detail"],"mappings":"uGAAA,IAAMA,EAAQ,EAAQ,GAKhBC,EAAkB,CACtB,YACA,gBACA,YACA,YACA,UACA,eACA,eACA,cACA,iBAGF,SAASC,EACPC,EACAC,GACkB,2BAAfC,EAAe,iCAAfA,EAAe,kBAElB,GAAoB,kBAATF,IAAsB,oBAAoBG,KAAKH,KAAUC,EAClE,OAAOJ,EAAMO,cAAcC,MAAM,KAA1B,CAAiCL,EAAMC,GAAvC,OAAiDC,IAG1D,IAAMI,EAAWC,OAAOC,OAAO,GAAIP,GAqCnC,OAlCAK,EAASG,IAAM,SAACC,GAQd,GAPyB,oBAAdT,EAAMQ,IACfR,EAAMQ,IAAIC,GACoB,kBAAdT,EAAMQ,MACrBR,EAAMQ,IAAYE,QAAUD,GAI3BA,EAMF,IAAK,IAAME,IAJuB,oBAA9BC,SAASC,KAAKb,EAAMc,OAA+BL,EAAQK,OAASd,EAAMc,OAC5EL,EAAQK,KAAOd,EAAMc,MAGLd,EAChB,GACEM,OAAOS,UAAUC,eAAeH,KAAKb,EAAOW,IAC5Cd,EAAgBoB,SAASN,EAAIO,gBACP,oBAAflB,EAAMW,MACXF,EAAQE,IAAQF,EAAQE,KAASX,EAAMW,IACzC,CACA,IAAMQ,EAAYR,EAAIO,cAAcE,QAAQ,KAAM,IAC9CX,EAAQE,IAEVF,EAAQY,oBAAoBF,EAAWV,EAAQE,IAAM,GAGvDF,EAAQa,iBAAiBH,EAAWnB,EAAMW,IAAM,GAChDF,EAAQE,GAAOX,EAAMW,KAMtBf,EAAMO,cAAcC,MAAM,KAA1B,CAAiCL,EAAMM,GAAvC,OAAoDJ,IAG7DsB,EAAOC,QAAU1B,EACjByB,EAAOC,QAAQC,QAAU3B,G,iCCjEzB,IAAM4B,EAAiC,CACrCC,SAAU,wBACVC,QAAS,wBACTC,QAAS,wBACTC,QAAS,wBACTC,QAAS,wBACTC,KAAM,wBACNC,KAAM,wBACNC,KAAM,wBACNC,SAAU,yBAMV7B,OAAO8B,KAAKV,GAAQW,SAAQ,SAAC1B,GAC3Be,EAAOf,GAAO2B,OAAOC,SAASC,UAIhC,MAA+BF,OAAOC,SAA9BE,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,SAClBhB,EAAOC,SAAP,UAAqBc,EAArB,aAAkCC,EAAlC,SACAhB,EAAOE,QAAP,UAAoBa,EAApB,aAAiCC,EAAjC,SAGahB,O,sFC4BAiB,UAjDF,WACX,MAA2CC,mBAAS,CAACC,IAAK,+CAA1D,mBAAOC,EAAP,KAAqBC,EAArB,KA8BA,OACE,eACE,iBACEC,KAAK,eACLC,IAAG,UAAKvB,IAAOQ,KAAZ,gBACHgB,UAAU,yBACVpC,KAAMgC,EACNK,UAnCN,WACEC,QAAQC,IAAI,kCAmCRC,cAhCN,WACEF,QAAQC,IAAI,8CAgCRE,UA7BN,WACEH,QAAQC,IAAI,mDAEZG,YAAW,WACTT,EAAmB,CAACF,IAAK,uDACxB,MAyBCY,UAtBN,WACEL,QAAQC,IAAI,kCAsBRK,QAnBN,WACEN,QAAQC,IAAI,8CAmBRM,aAhBN,SAA2BC,GACzBR,QAAQC,IAAI,gEAAyBO,EAAEC,OAAO/C","file":"static/js/vue3.3246075f.chunk.js","sourcesContent":["const React = require('react')\n\ntype MicroElementType = HTMLElement & Record<string, unknown>\n\n// lifecycles\nconst eventLifeCycles = [\n  'oncreated',\n  'onbeforemount',\n  'onmounted',\n  'onunmount',\n  'onerror',\n  'ondatachange',\n  'onbeforeshow',\n  'onaftershow',\n  'onafterhidden',\n]\n\nfunction jsxCustomEvent (\n  type: string | CallableFunction,\n  props: Record<string, unknown> | null,\n  ...children: any[]\n): void {\n  if (typeof type !== 'string' || !/^micro-app(-\\S+)?/.test(type) || !props) {\n    return React.createElement.apply(null, [type, props, ...children])\n  }\n\n  const newProps = Object.assign({}, props)\n\n  // ref will call when create, update, unmount\n  newProps.ref = (element: MicroElementType | null) => {\n    if (typeof props.ref === 'function') {\n      props.ref(element)\n    } else if (typeof props.ref === 'object') {\n      (props.ref as any).current = element\n    }\n\n    // when unmount and update the element is null\n    if (element) {\n      // Update data when the prev and next data are different\n      if (toString.call(props.data) === '[object Object]' && element.data !== props.data) {\n        element.data = props.data\n      }\n\n      for (const key in props) {\n        if (\n          Object.prototype.hasOwnProperty.call(props, key) &&\n          eventLifeCycles.includes(key.toLowerCase()) &&\n          typeof props[key] === 'function' &&\n          (!element[key] || element[key] !== props[key])\n        ) {\n          const eventName = key.toLowerCase().replace('on', '')\n          if (element[key]) {\n            // @ts-ignore\n            element.removeEventListener(eventName, element[key], false)\n          }\n          // @ts-ignore\n          element.addEventListener(eventName, props[key], false)\n          element[key] = props[key]\n        }\n      }\n    }\n  }\n\n  return React.createElement.apply(null, [type, newProps, ...children])\n}\n\nmodule.exports = jsxCustomEvent\nmodule.exports.default = jsxCustomEvent\n","\n// 开发环境地址\nconst config: Record<string, string> = {\n  nextjs11: 'http://localhost:4002',\n  nuxtjs2: 'http://localhost:4003',\n  react16: 'http://localhost:4004',\n  react17: 'http://localhost:4005',\n  sidebar: 'http://localhost:4006',\n  vite: 'http://localhost:4007',\n  vue2: 'http://localhost:4008',\n  vue3: 'http://localhost:4009',\n  webpack5: 'http://localhost:4010'\n}\n\n// 线上环境地址\nif (process.env.NODE_ENV === 'production') {\n  // 基座应用和子应用部署在同一个域名下，这里使用location.origin进行补全\n  Object.keys(config).forEach((key) => {\n    config[key] = window.location.origin\n  })\n\n  // 在部署后，nextjs11和nuxtjs2依然和开发环境保持一致，绑定5005和6005端口，这里单独处理\n  const { protocol, hostname } = window.location\n  config.nextjs11 = `${protocol}//${hostname}:5005`\n  config.nuxtjs2 = `${protocol}//${hostname}:6005`\n}\n\nexport default config\n","/** @jsxRuntime classic */\n/** @jsx jsxCustomEvent */\nimport jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'\nimport { useState } from 'react'\nimport config from '../../config'\n\nconst Vue3 = () => {\n  const [microAppData, changeMicroAppData] = useState({msg: '来自基座的数据'})\n\n  function handleCreate () {\n    console.log('child-vue3 创建了')\n  }\n\n  function handleBeforeMount () {\n    console.log('child-vue3 即将被渲染')\n  }\n\n  function handleMount () {\n    console.log('child-vue3 已经渲染完成')\n\n    setTimeout(() => {\n      changeMicroAppData({msg: '来自基座的新数据'})\n    }, 2000)\n  }\n\n  function handleUnmount () {\n    console.log('child-vue3 卸载了')\n  }\n\n  function handleError () {\n    console.log('child-vue3 加载出错了')\n  }\n\n  function handleDataChange (e: CustomEvent) {\n    console.log('来自子应用 child-vue3 的数据:', e.detail.data)\n  }\n\n  return (\n    <div>\n      <micro-app\n        name='appname-vue3'\n        url={`${config.vue3}/child/vue3/`}\n        baseroute='/main-react17/app-vue3'\n        data={microAppData}\n        onCreated={handleCreate}\n        onBeforemount={handleBeforeMount}\n        onMounted={handleMount}\n        onUnmount={handleUnmount}\n        onError={handleError}\n        onDataChange={handleDataChange}\n      ></micro-app>\n    </div>\n  )\n}\n\nexport default Vue3\n"],"sourceRoot":""}